<% provide :title, t("debates.index.title") %>
<% content_for :header_addon do %>
  <%= render "shared/search_form",
             search_path: debates_path(page: 1),
             i18n_namespace: "debates.index.search_form" %>
<% end %>
<% content_for :canonical do %>
  <%= render "shared/canonical", href: debates_url %>
<% end %>

<% if @search_terms || @advanced_search_terms %>
  <%= render Shared::SearchResultsSummaryComponent.new(
    results: @debates,
    search_terms: @search_terms,
    advanced_search_terms: @advanced_search_terms
  ) %>
<% else %>
  <%= render "shared/section_header", i18n_namespace: "debates.index.section_header", image: "debates" %>
<% end %>


<div class="row">
  <div id="debates" class="debates-list small-12 medium-9 column">

    <%= render Shared::BannerComponent.new("debates") %>

    <div class="row">
      <div class="small-12 column">
        <%= render "view_mode" %>
      </div>
    </div>

    <div class="show-for-small-only">
      <%= link_to t("debates.index.start_debate"), new_debate_path, class: "button expanded" %>
    </div>

    <% if @debates.any? || current_user.blank? %>
      <% if debates_default_view? %>
        <%= render @debates %>
      <% else %>
        <% @debates.each do |debate| %>
          <%= render "debates/debate_minimal", debate: debate %>
        <% end %>
      <% end %>
    <% else %>
      <%= empty_recommended_debates_message_text(current_user) %>
    <% end %>
    <%= paginate @debates %>

  </div>

  <div class="small-12 medium-3 column">

    <aside class="margin-bottom">
      <% if current_user&.role != "student" %>
        <%= link_to t("debates.index.start_debate"), new_debate_path, class: "button expanded" %>
      <% end %>
      <%= render "shared/tag_cloud",
                taggable: "Debate",
                tags: ActsAsTaggableOn::Tag.unscoped.order(:name) %>
    </aside>
      <% if current_user %>
        <div class="sidebar-divider"></div>
        <h2 class="sidebar-title">Contact Persons</h2>
        <br>
        <ul class="no-bullet categories">
          <li class="inline-block">
            <% css_class = { class: "is-active text-black" } if params[:view] == "contacts" %>
            <%= link_to "Internship Contact Persons",
                        internship_contacts_path(view: "contacts"),
                        css_class || {} %>
          </li>
        </ul>
      <% end %>
  </div>
</div>
